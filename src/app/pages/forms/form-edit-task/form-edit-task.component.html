<div class="form-bg">
    <div class="form-content">
        <form [formGroup]="editTask" submit="onSubmit()">
            <div class="edit--task">
                <!-- can't stylize form as it's from material -->
                <!-- <section>

                    <div>Barre d'Ã©volution</div>  <span>{{task?.progression}}%</span>
                    <span>Mark complete</span>
                </section> -->
                <section>
                    <mat-form-field>
                        <input matInput placeholder="Task's name" name="name" type="text" formControlName="name"
                            required>
                        <mat-error *ngIf="editTask.controls['name'].invalid">The name is required</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <textarea matInput placeholder="Description" name="description" ngMaxlength="250"
                            formControlName="description"></textarea>
                    </mat-form-field>
                    <mat-form-field>
                        <input matInput placeholder="Time estimated" name="estimated" formControlName="estimated">
                    </mat-form-field>
                    <mat-form-field>
                        <input matInput [matDatepicker]="deadline" placeholder="Deadline" formControlName="deadline">
                        <mat-datepicker-toggle matSuffix [for]="deadline"></mat-datepicker-toggle>
                        <mat-datepicker #deadline></mat-datepicker>
                    </mat-form-field>
                    <mat-form-field>
                        <p>Priority : </p>
                        <select matNativeControl name="priority" id="priority" formControlName="priority">
                            <option value="none">None</option>
                            <option value="high">High</option>
                            <option value="middle">Middle</option>
                            <option value="low">Low</option>
                        </select> <br />
                    </mat-form-field>
                    <p (click)="getCreator()">created by {{getCreator() | async as user}}</p>
                </section>
                <section>
                    <h4>Members</h4>
                    <ul>
                        <li *ngFor="let member of task?.assigned; let i = index" class="task--member">
                            <img src="{{member.avatar_url}}"
                                alt="{{member.user_id}}">
                            <p>{{ member.user_id }}</p>
                            <fa-icon class="task--remove" [icon]="faTrash" size="1x" (click)="unnasignedUser(member.user_id)"></fa-icon>
                        </li>
                    </ul>

                    <div class="task--assign">
                        <mat-form-field>
                            <mat-label>Assign a member</mat-label>
                            <mat-select matNativeControl name="assigned" formControlName="assigned" >
                                <mat-option [value]="email" *ngFor="let email of emails; let i = index">{{email}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <button class="middlebutton" (click)="addAssignedUser(editTask.get('assigned').value)">add member</button>
                    </div>

                    <h4>To do list</h4>
                    <ul>
                        <li *ngFor="let c of task?.checklist; let i = index" class="task--checklist">
                            <input type="checkbox" /><label for="checklist">{{c.name}}</label>
                            
                            <fa-icon class="task--remove" [icon]="faTrash" size="1x" (click)="removeFromChecklist(i)"></fa-icon>
                        </li>
                    </ul>
                    <input name="addingtochecklist" type="text" maxlength="20" [(ngModel)]="addCheckList"
                        [ngModelOptions]="{standalone: true}" (keyup.enter)="addToCheckList()">
                </section>
            </div>

            <div>
                <button mat-raised-button type="submit" (click)="onSubmit()">Edit Task</button>
                <button mat-raised-button (click)="deleteTask()" class="deletebutton">Delete</button>
            </div>
        </form>
    </div>
</div>